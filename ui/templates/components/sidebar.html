<nav class="modern-sidebar">
    <div class="sidebar-brand">
        <div class="brand-icon">
            <i class="fas fa-rocket"></i>
        </div>
        <div class="brand-text">
            <h3>Fun Work Hub</h3>
            <p>Smart Management</p>
        </div>
    </div>

    <div class="user-profile-card">
        <div class="user-avatar-lg">
            {{ ((user.first_name or user.name or user.email) if user.first_name or user.name else user.email)[0]|upper }}
        </div>
        <div class="user-info">
            <div class="user-name">{{ user.first_name or user.name or 'User' }} {{ user.last_name or '' }}</div>
            <div class="user-email">{{ user.email }}</div>
            <span class="role-badge role-{{ user.role }}">
                <i
                    class="fas fa-{{ 'crown' if user.role == 'admin' else 'user-shield' if user.role == 'manager' else 'user' }}"></i>
                {{ user.role|upper }}
            </span>
        </div>
    </div>

    <div class="menu-container">
        <!-- Admin Section: Quản trị hệ thống -->
        {% if user.role == 'admin' %}
        <div class="menu-section">
            <div class="section-title">
                <i class="fas fa-crown"></i>
                <span>Quản trị hệ thống</span>
            </div>
            <a class="menu-item" href="{{ url_for('admin_analytics') }}">
                <div class="menu-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);"><i
                        class="fas fa-chart-line"></i></div>
                <div class="menu-label">Thống kê & Báo cáo</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
            <a class="menu-item" href="{{ url_for('admin_subscriptions') }}">
                <div class="menu-icon" style="background: linear-gradient(135deg, #ffd89b 0%, #ff8a00 100%);"><i
                        class="fas fa-credit-card"></i></div>
                <div class="menu-label">Quản lý Gói Manager</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
        </div>
        {% endif %}

        <!-- Manager Section: Tạo tài khoản User -->
        {% if user.role == 'manager' %}
        <div class="menu-section">
            <div class="section-title">
                <i class="fas fa-user-plus"></i>
                <span>Quản lý User</span>
            </div>
            <a class="menu-item" href="{{ url_for('create_user_account') }}">
                <div class="menu-icon"><i class="fas fa-user-plus"></i></div>
                <div class="menu-label">Tạo tài khoản User</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
        </div>
        {% endif %}

        <!-- Main Menu: Dành cho Manager/Admin -->
        {% if user.role in ['admin', 'manager'] %}
        <div class="menu-section">
            <div class="section-title">
                <i class="fas fa-store"></i>
                <span>Quản lý kinh doanh</span>
            </div>
            <a class="menu-item" href="{{ url_for('dashboard') }}">
                <div class="menu-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"><i
                        class="fas fa-chart-pie"></i></div>
                <div class="menu-label">Dashboard (Kiếm tiền)</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
            <a class="menu-item" href="{{ url_for('customers') }}">
                <div class="menu-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"><i
                        class="fas fa-users"></i></div>
                <div class="menu-label">Khách hàng</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
            <a class="menu-item" href="{{ url_for('wallet_dashboard') }}">
                <div class="menu-icon" style="background: linear-gradient(135deg, #1f2937 0%, #111827 100%);"><i
                        class="fas fa-wallet"></i></div>
                <div class="menu-label">Ví & Gói Manager</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
        </div>
        {% endif %}
        
        <!-- User Menu: Chức năng cơ bản -->
        {% if user.role == 'user' %}
        <div class="menu-section">
            <div class="section-title">
                <i class="fas fa-store"></i>
                <span>Quản lý kinh doanh</span>
            </div>
            <a class="menu-item" href="{{ url_for('customers') }}">
                <div class="menu-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"><i
                        class="fas fa-users"></i></div>
                <div class="menu-label">Khách hàng</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
        </div>
        {% endif %}

        <!-- Workspace -->
        <div class="menu-section">
            <div class="section-title">
                <i class="fas fa-rocket"></i>
                <span>Workspace</span>
            </div>
            <a class="menu-item" href="{{ url_for('workspace') }}">
                <div class="menu-icon" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);"><i
                        class="fas fa-paint-brush"></i></div>
                <div class="menu-label">Workspace Hub</div>
                <div class="menu-arrow"><i class="fas fa-chevron-right"></i></div>
            </a>
        </div>

        <!-- Logout -->
        <div class="menu-footer">
            <a class="logout-button" href="{{ url_for('logout') }}">
                <i class="fas fa-sign-out-alt"></i>
                <span>Đăng xuất</span>
            </a>
        </div>
    </div>
</nav>