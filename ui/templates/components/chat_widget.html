<!-- Chat Widget -->
<div id="ai-chat-widget" class="ai-chat-widget">
    <!-- Chat Button -->
    <button id="ai-chat-toggle" class="ai-chat-toggle" aria-label="Open AI Assistant">
        <i class="fas fa-robot"></i>
    </button>

    <!-- Chat Window -->
    <div id="ai-chat-window" class="ai-chat-window" hidden>
        <div class="ai-chat-header">
            <div class="ai-chat-title">
                <i class="fas fa-robot"></i>
                <span>Retail Assistant</span>
            </div>
            <div class="ai-chat-controls">
                <button id="ai-chat-minimize" class="ai-chat-control-btn" aria-label="Minimize">
                    <i class="fas fa-minus"></i>
                </button>
            </div>
        </div>

        <div id="ai-chat-messages" class="ai-chat-messages">
            <!-- Messages will appear here -->
        </div>

        <!-- NEW: DEEP RESEARCH UI CONTAINER -->
        <div id="agent-process" class="agent-process-container">
            <div class="process-header">
                <div class="spinner-ring"></div>
                <span id="process-status-text">Analyzing Request...</span>
            </div>
            <div class="process-steps" id="process-steps"></div>
        </div>
        <!-- END NEW -->

        <!-- Typing Indicator (Fallback) -->
        <div id="ai-chat-typing" class="typing-indicator" style="display:none;">
            <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </div>

        <div class="ai-chat-input-wrapper">
            <!-- File Preview -->
            <div id="ai-chat-file-preview" class="image-preview" style="display:none;">
                <span id="ai-chat-file-name"><i class="fas fa-file"></i> File</span>
                <span class="remove-img" id="ai-chat-clear-file">✕</span>
            </div>

            <div class="ai-input-bar">
                <input type="file" id="ai-chat-file-input" accept="image/*,video/*,application/pdf"
                    style="display: none;">
                <button class="attach-btn" id="ai-chat-attach-btn" title="Gửi ảnh/file">
                    <i class="fas fa-paperclip"></i>
                </button>
                <input type="text" id="ai-chat-input" placeholder="Nhập tin nhắn..." autocomplete="off">
                <button id="ai-chat-send" class="send-btn" title="Gửi">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
</div>